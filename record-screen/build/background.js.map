{"version":3,"file":"background.js","sources":["../../node_modules/.pnpm/svelte@3.35.0/node_modules/svelte/store/index.mjs","../../src/common/Store.ts","../../src/background/store.ts","../../src/background/Storage.ts","../../src/background/background.ts"],"sourcesContent":["import { noop, safe_not_equal, subscribe, run_all, is_function } from '../internal/index.mjs';\nexport { get_store_value as get } from '../internal/index.mjs';\n\nconst subscriber_queue = [];\n/**\n * Creates a `Readable` store that allows reading by subscription.\n * @param value initial value\n * @param {StartStopNotifier}start start and stop notifications for subscriptions\n */\nfunction readable(value, start) {\n    return {\n        subscribe: writable(value, start).subscribe\n    };\n}\n/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n * @param {*=}value initial value\n * @param {StartStopNotifier=}start start and stop notifications for subscriptions\n */\nfunction writable(value, start = noop) {\n    let stop;\n    const subscribers = [];\n    function set(new_value) {\n        if (safe_not_equal(value, new_value)) {\n            value = new_value;\n            if (stop) { // store is ready\n                const run_queue = !subscriber_queue.length;\n                for (let i = 0; i < subscribers.length; i += 1) {\n                    const s = subscribers[i];\n                    s[1]();\n                    subscriber_queue.push(s, value);\n                }\n                if (run_queue) {\n                    for (let i = 0; i < subscriber_queue.length; i += 2) {\n                        subscriber_queue[i][0](subscriber_queue[i + 1]);\n                    }\n                    subscriber_queue.length = 0;\n                }\n            }\n        }\n    }\n    function update(fn) {\n        set(fn(value));\n    }\n    function subscribe(run, invalidate = noop) {\n        const subscriber = [run, invalidate];\n        subscribers.push(subscriber);\n        if (subscribers.length === 1) {\n            stop = start(set) || noop;\n        }\n        run(value);\n        return () => {\n            const index = subscribers.indexOf(subscriber);\n            if (index !== -1) {\n                subscribers.splice(index, 1);\n            }\n            if (subscribers.length === 0) {\n                stop();\n                stop = null;\n            }\n        };\n    }\n    return { set, update, subscribe };\n}\nfunction derived(stores, fn, initial_value) {\n    const single = !Array.isArray(stores);\n    const stores_array = single\n        ? [stores]\n        : stores;\n    const auto = fn.length < 2;\n    return readable(initial_value, (set) => {\n        let inited = false;\n        const values = [];\n        let pending = 0;\n        let cleanup = noop;\n        const sync = () => {\n            if (pending) {\n                return;\n            }\n            cleanup();\n            const result = fn(single ? values[0] : values, set);\n            if (auto) {\n                set(result);\n            }\n            else {\n                cleanup = is_function(result) ? result : noop;\n            }\n        };\n        const unsubscribers = stores_array.map((store, i) => subscribe(store, (value) => {\n            values[i] = value;\n            pending &= ~(1 << i);\n            if (inited) {\n                sync();\n            }\n        }, () => {\n            pending |= (1 << i);\n        }));\n        inited = true;\n        sync();\n        return function stop() {\n            run_all(unsubscribers);\n            cleanup();\n        };\n    });\n}\n\nexport { derived, readable, writable };\n","import { writable, get } from \"svelte/store\";\n\nexport default class Store<T> {\n  set: (value: T) => void;\n  update: (updater: (value: T) => T) => void;\n  subscribe: (callback: (value: T) => void) => Function;\n\n  constructor(value: T = undefined) {\n    const { set, update, subscribe } = writable<T>(value);\n    this.set = set;\n    this.update = update;\n    this.subscribe = subscribe;\n  }\n\n  get(): T {\n    return get(<any>this);\n  }\n}\n","import Store from \"../common/Store\";\n\nexport const status = new Store(\"idle\");\nexport const currentStream = new Store<MediaStream>();\nexport const list = new Store<Array<ListItem>>(\n  JSON.parse(localStorage.getItem(\"recorded_sessions\")) || []\n);\n\nlist.subscribe((updatedList) => {\n  localStorage.setItem(\"recorded_sessions\", JSON.stringify(updatedList));\n});\n","export default class Storage {\n  private fs;\n  quote: number;\n  constructor(quote: number) {\n    this.quote = quote;\n  }\n\n  init() {\n    return new Promise((resolve, reject) => {\n      window[\"webkitRequestFileSystem\"](\n        1,\n        this.quote,\n        (fs) => {\n          this.fs = fs;\n          resolve(this);\n        },\n        (error) => {\n          reject(error);\n        }\n      );\n    });\n  }\n\n  write(\n    blob: Blob,\n    filename = Math.floor(Math.random() * Number.MAX_SAFE_INTEGER).toString(36)\n  ): Promise<string> {\n    return new Promise((resolve, reject) => {\n      this.fs.root.getFile(\n        filename,\n        { create: true, exclusive: true },\n        function (entry) {\n          entry.createWriter(function (fileWriter) {\n            fileWriter.onwriteend = function (e) {\n              resolve(filename);\n            };\n\n            fileWriter.onerror = function (e) {\n              reject(new Error(e.message));\n            };\n\n            fileWriter.write(blob);\n          }, console.error);\n        },\n        console.error\n      );\n    });\n  }\n\n  read(filename: string): Promise<Blob> {\n    return new Promise((resolve, reject) => {\n      this.fs.root.getFile(\n        filename,\n        {},\n        function (entry) {\n          entry.file(\n            async function (file) {\n              const buffer = await file.arrayBuffer();\n              resolve(new Blob([buffer]));\n            },\n            (e) => reject(e.message)\n          );\n        },\n        (e) => reject(e.message)\n      );\n      return new Blob([]);\n    });\n  }\n\n  remove(filename: string) {\n    return new Promise((resolve, reject) => {\n      this.fs.root.getFile(\n        filename,\n        { create: false },\n        function (fileEntry) {\n          fileEntry.remove(\n            function () {\n              resolve(true);\n            },\n            (e) => reject(e.message)\n          );\n        },\n        (e) => reject(e.message)\n      );\n    });\n  }\n}\n","import { list, status } from \"./store\";\nimport Storage from \"./Storage\";\n\nwindow[\"log\"] = function () {\n  console.log(...arguments);\n};\n\nlet currentStream: MediaStream;\nlet record: ListItem = undefined;\nlet mic = false;\n\nlet storage = new Storage(20 * 1024 ** 3);\nstorage.init();\nwindow[\"storage\"] = storage;\n\nwindow[\"execCommand\"] = function (command: ExecCommand, options: any = {}) {\n  switch (command) {\n    case \"GET_STATUS\":\n      return getStatus();\n    case \"START_REC\":\n      return startRecording();\n    case \"STOP_REC\":\n      return stopRecording(currentStream);\n    case \"GET_LIST\":\n      return list.get();\n    case \"RENAME_ITEM\":\n      list.update((list) => {\n        const itemIndex = list.findIndex((item) => item.id === options.id);\n        if (itemIndex > -1) {\n          list[itemIndex].name = options.name;\n        }\n        return list;\n      });\n      return list;\n    case \"DELETE_ITEM\":\n      storage.remove(options.id).then((result) => {\n        list.update((list) => {\n          return list.filter((item) => item.id !== options.id);\n        });\n      });\n      return;\n    case \"DOWNLOAD_ITEM\": {\n      const id = options.id;\n      const item = list.get().find((item) => item.id === id);\n      storage.read(id).then(async (blob) => {\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement(\"a\");\n        a.href = url;\n        a.download = item.name;\n        a.click();\n        setTimeout(() => {\n          URL.revokeObjectURL(url);\n        }, 10000);\n      });\n      return;\n    }\n    case \"UPLOAD_ITEM\":\n      return;\n    case \"PLAY_ITEM\": {\n      const id = options.id;\n      const item = list.get().find((item) => item.id === id);\n      storage.read(id).then(async (blob) => {\n        const url = URL.createObjectURL(new File([blob], \"video.webm\"));\n        window[\"chrome\"].tabs.create({ url: `play.html#${url}` });\n      });\n      return;\n    }\n    case \"UNMUTE\":\n      mic = true;\n      return;\n    case \"MUTE\":\n      mic = false;\n      return;\n    case \"GET_MUTE\":\n      return mic;\n  }\n};\n\nfunction getStatus() {\n  return status.get();\n}\n\nasync function startRecording(audio: boolean = !!mic) {\n  try {\n    if (getStatus() !== \"idle\") return { error: \"STATUS NOT IDLE\" };\n\n    const name = `record_${new Date().getTime()}.webm`;\n    record = { id: name, name, created_at: new Date().getTime() };\n\n    const screenStream: MediaStream = await navigator.mediaDevices[\n      \"getDisplayMedia\"\n    ]({\n      video: true,\n      audio: !!audio,\n    });\n\n    let videoTracks = screenStream.getVideoTracks();\n    let audioTracks = screenStream.getAudioTracks();\n\n    if (!!audio) {\n      const micStream = await navigator.mediaDevices.getUserMedia({\n        audio: !!audio,\n      });\n      audioTracks = micStream.getAudioTracks();\n    }\n\n    const finalStream = new MediaStream([...audioTracks, ...videoTracks]);\n\n    status.set(\"recording\");\n    currentStream = finalStream;\n    const recorder = new window[\"MediaRecorder\"](finalStream, {\n      mimeType: \"video/webm; codecs=vp9\",\n    });\n    recorder.start();\n    recorder.ondataavailable = async ({ data: blob }: { data: Blob }) => {\n      await storage.write(blob, name);\n    };\n\n    // handle stop recording\n    const track = screenStream.getVideoTracks()[0];\n    track.addEventListener(\"ended\", () => {\n      stopRecording(finalStream);\n      stopRecording(screenStream);\n    });\n    return name;\n  } catch (error) {\n    return console.log(\"Error:\", error.message);\n  }\n}\n\nfunction stopRecording(stream: MediaStream) {\n  stream.getTracks().forEach((track) => {\n    track.stop();\n  });\n  onStop();\n}\n\nfunction onStop() {\n  status.set(\"idle\");\n  list.update((list) => {\n    if (!list.find((item) => item.id === record.id)) list.push(record);\n    return list;\n  });\n}\n"],"names":["get"],"mappings":"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"}